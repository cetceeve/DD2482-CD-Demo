<!DOCTYPE html>
<html>
<head>
    <title>JavaScript GET Request</title>
    <script src="{{ url_for('static', filename='qrcode.min.js') }}"></script>
    <script type="text/javascript">
        function redirectToUrl() {
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (this.readyState === 4 && this.status === 200) {
                    const data = JSON.parse(this.responseText);
                    window.location.href = data.url;
                } else if (this.readyState === 4) {
                    document.getElementById('result').innerText = `Error: ${this.status}`;
                }
            };
            xhr.open("GET", location.origin + "/get_url", true);
            xhr.send();
        }

        function QrCodeGenerator() {
            // http://192.168.0.106 --> Need to change depends the network
            const serverUrl = "http://ec2-16-16-80-177.eu-north-1.compute.amazonaws.com/";
            new QRCode(document.getElementById('qrcode'), serverUrl);
        }

        window.onload = QrCodeGenerator;
    </script>
</head>
<body>
    <h1>Redirect to best search engine</h1>
    <button onclick="redirectToUrl()">Go to URL</button>
    <p id="result"></p>
    <h2> Please scan this WQ code</h2>
    <div id="qrcode"> </div>
</body>
</html>
